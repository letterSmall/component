<div class="splunpan-container">
  <div class="splunpan-box">
  <div class="splunpan-box-left">
            {% if section.settings.image_over %}
    <img class="lunpanover-img" src="{{ section.settings.image_over | img_url:'master' }}"/>
   {% endif %}
    {% if section.settings.image %}
    <img src="{{ section.settings.image | img_url:'master' }}"/>
   {% endif %}

  </div>
  
  <div class="splunpan-box-right">
    {% if section.settings.title != blank %}
  <div class="splunpanbox-title">{{ section.settings.title }}</div>
   {% endif %}
    {% if section.settings.content != blank %}
  <div class="splunpanbox-content">{{ section.settings.content }}</div>
   {% endif %}
  {% if section.settings.note != blank %}
  <div class="splunpanbox-note">{{ section.settings.note }}</div>
   {% endif %}
    
    <div  class="Springonsale-box-btnbox">
      {% if section.settings.start_text != blank%}
      <span class="splunpanboxbtn-start btn_ho"><span>{{section.settings.start_text}}</span></span>
       {% endif %}
      
       {% if section.settings.check_text != blank%}
      <a class="splunpanboxbtn-check btn_ho02" href="{{section.settings.check_url}}"><span>{{section.settings.check_text}}</span></a>
       {% endif %}
    </div>
  </div>
  </div>
</div>

<script>

(function() {
	var lastTime = 0;
	var vendors = ['webkit', 'moz'];
	for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {
		window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];
		window.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] || window[vendors[x] + 'CancelRequestAnimationFrame'];
	}
	if(!window.requestAnimationFrame)
		window.requestAnimationFrame = function(callback, element) {
			var currTime = new Date().getTime();
			var timeToCall = Math.max(0, 16 - (currTime - lastTime));
			var id = window.setTimeout(function() {
				callback(currTime + timeToCall);
			}, timeToCall);
			lastTime = currTime + timeToCall;
			return id;
		};
	if(!window.cancelAnimationFrame)
		window.cancelAnimationFrame = function(id) {
			clearTimeout(id);
		};
}());
(function($) {
	$.snowfall = function(element, options) {
		var defaults = {
				flakeCount: 35,
				flakeColor: '#ffffff',
				flakePosition: 'absolute',
				flakeIndex: 999999,
				minSize: 1,
				maxSize: 2,
				minSpeed: 1,
				maxSpeed: 4,
				round: false,
				shadow: false,
				collection: false,
				collectionHeight: 40,
				deviceorientation: false
			}, 
			options = $.extend(defaults, options),
			random = function random(min, max) {
				return Math.round(min + Math.random() * (max - min));
			};
		$(element).data("snowfall", this);

		function Flake(_x, _y, _size, _speed, _id) {
			this.id = _id;
			this.x = _x;
			this.y = _y;
			this.size = _size;
			this.speed = _speed;
			this.step = 0;
			this.stepSize = random(1, 10) / 100;
			if(options.collection) {
				this.target = canvasCollection[random(0, canvasCollection.length - 1)];
			}
			var flakeMarkup = null;
			if(options.image) {
                var indexho = parseInt(Math.random()*10);
             var shuzu = ['https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/Vector-4.png?v=1648801985','https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/Vector-23.png?v=1648802165','https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/Vector-66.png?v=1648802177','https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/Vector-48.png?v=1648802748','https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/Vector-53.png?v=1648802760','https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/Vector-75.png?v=1648802820','https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/Vector-62.png?v=1648802952','https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/Vector-69.png?v=1648803004','https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/Vector-46.png?v=1648803031','https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/Vector-30.png?v=1648803068'] 
				
             flakeMarkup = $(document.createElement("img"));
				flakeMarkup[0].src = shuzu[indexho];
			} else {
             var indexho = parseInt(Math.random()*10);
             var shuzu = ['https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/Vector-4.png?v=1648801985','https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/Vector-23.png?v=1648802165','https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/Vector-66.png?v=1648802177','https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/Vector-48.png?v=1648802748','https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/Vector-53.png?v=1648802760','https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/Vector-75.png?v=1648802820','https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/Vector-62.png?v=1648802952','https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/Vector-69.png?v=1648803004','https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/Vector-46.png?v=1648803031','https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/Vector-30.png?v=1648803068']  
				flakeMarkup = $(document.createElement("div"));
				flakeMarkup.css({
					'background': 'url('+shuzu[indexho]+')'
				});
			}
			flakeMarkup.attr({
				'class': 'snowfall-flakes',
				'id': 'flake-' + this.id
			}).css({
				'width': this.size,
				'height': this.size,
				'position': options.flakePosition,
				'top': this.y,
				'left': this.x,
				'fontSize': 0,
				'zIndex': options.flakeIndex
			});
			if($(element).get(0).tagName === $(document).get(0).tagName) {
				$('body').append(flakeMarkup);
				element = $('body');
			} else {
				$(element).append(flakeMarkup);
			}
			this.element = document.getElementById('flake-' + this.id);
			this.update = function() {
				this.y += this.speed;
				if(this.y > (elHeight) - (this.size + 6)) {
					this.reset();
				}
				this.element.style.top = this.y + 'px';
				this.element.style.left = this.x + 'px';
				this.step += this.stepSize;
				if(doRatio === false) {
					this.x += Math.cos(this.step);
				} else {
					this.x += (doRatio + Math.cos(this.step));
				}
				if(options.collection) {
					if(this.x > this.target.x && this.x < this.target.width + this.target.x && this.y > this.target.y && this.y < this.target.height + this.target.y) {
						var ctx = this.target.element.getContext("2d"),
							curX = this.x - this.target.x,
							curY = this.y - this.target.y,
							colData = this.target.colData;
						if(colData[parseInt(curX)][parseInt(curY + this.speed + this.size)] !== undefined || curY + this.speed + this.size > this.target.height) {
							if(curY + this.speed + this.size > this.target.height) {
								while(curY + this.speed + this.size > this.target.height && this.speed > 0) {
									this.speed *= .5;
								}
								ctx.fillStyle = "#fff";
								if(colData[parseInt(curX)][parseInt(curY + this.speed + this.size)] == undefined) {
									colData[parseInt(curX)][parseInt(curY + this.speed + this.size)] = 1;
									ctx.fillRect(curX, (curY) + this.speed + this.size, this.size, this.size);
								} else {
									colData[parseInt(curX)][parseInt(curY + this.speed)] = 1;
									ctx.fillRect(curX, curY + this.speed, this.size, this.size);
								}
								this.reset();
							} else {
								this.speed = 1;
								this.stepSize = 0;
								if(parseInt(curX) + 1 < this.target.width && colData[parseInt(curX) + 1][parseInt(curY) + 1] == undefined) {
									this.x++;
								} else if(parseInt(curX) - 1 > 0 && colData[parseInt(curX) - 1][parseInt(curY) + 1] == undefined) {
									this.x--;
								} else {
									ctx.fillStyle = "#fff";
									ctx.fillRect(curX, curY, this.size, this.size);
									colData[parseInt(curX)][parseInt(curY)] = 1;
									this.reset();
								}
							}
						}
					}
				}
				if(this.x > (elWidth) - widthOffset || this.x < widthOffset) {
					this.reset();
				}
			}
			this.reset = function() {
				this.y = 0;
				this.x = random(widthOffset, elWidth - widthOffset);
				this.stepSize = random(1, 10) / 100;
				this.size = random((options.minSize * 100), (options.maxSize * 100)) / 100;
				this.speed = random(options.minSpeed, options.maxSpeed);
			}
		} 
		var flakes = [],
			flakeId = 0,
			i = 0,
			elHeight = $(element).height(),
			elWidth = $(element).width(),
			widthOffset = 0,
			snowTimeout = 0;
		if(options.collection !== false) {
			var testElem = document.createElement('canvas');
			if(!!(testElem.getContext && testElem.getContext('2d'))) {
				var canvasCollection = [],
					elements = $(options.collection),
					collectionHeight = options.collectionHeight;
				for(var i = 0; i < elements.length; i++) {
					var bounds = elements[i].getBoundingClientRect(),
						canvas = document.createElement('canvas'),
						collisionData = [];
					if(bounds.top - collectionHeight > 0) {
						document.body.appendChild(canvas);
						canvas.style.position = options.flakePosition;
						canvas.height = collectionHeight;
						canvas.width = bounds.width;
						canvas.style.left = bounds.left + 'px';
						canvas.style.top = bounds.top - collectionHeight + 'px';
						for(var w = 0; w < bounds.width; w++) {
							collisionData[w] = [];
						}
						canvasCollection.push({
							element: canvas,
							x: bounds.left,
							y: bounds.top - collectionHeight,
							width: bounds.width,
							height: collectionHeight,
							colData: collisionData
						});
					}
				}
			} else {
				options.collection = false;
			}
		}
		if($(element).get(0).tagName === $(document).get(0).tagName) {
			widthOffset = 25;
		}
		$(window).bind("resize", function() {
			elHeight = $(element)[0].clientHeight;
			elWidth = $(element)[0].offsetWidth;
		});
		for(i = 0; i < options.flakeCount; i += 1) {
			flakeId = flakes.length;
			flakes.push(new Flake(random(widthOffset, elWidth - widthOffset), random(0, elHeight), random((options.minSize * 100), (options.maxSize * 100)) / 100, random(options.minSpeed, options.maxSpeed), flakeId));
		}
		if(options.round) {
			$('.snowfall-flakes').css({
				'-moz-border-radius': options.maxSize,
				'-webkit-border-radius': options.maxSize,
				'border-radius': options.maxSize
			});
		}
		if(options.shadow) {
			$('.snowfall-flakes').css({
				'-moz-box-shadow': '1px 1px 1px #555',
				'-webkit-box-shadow': '1px 1px 1px #555',
				'box-shadow': '1px 1px 1px #555'
			});
		}
		var doRatio = false;
		if(options.deviceorientation) {
			$(window).bind('deviceorientation', function(event) {
				doRatio = event.originalEvent.gamma * 0.1;
			});
		}

		function snow() {
			for(i = 0; i < flakes.length; i += 1) {
				flakes[i].update();
			}
			snowTimeout = requestAnimationFrame(function() {
				snow()
			});
		}
		snow();
		this.clear = function() {
			$(element).children('.snowfall-flakes').remove();
			flakes = [];
			cancelAnimationFrame(snowTimeout);
		}
	};
	$.fn.snowfall = function(options) {
		if(typeof(options) == "object" || options == undefined) {
			return this.each(function(i) {
				(new $.snowfall(this, options));
			});
		} else if(typeof(options) == "string") {
			return this.each(function(i) {
				var snow = $(this).data('snowfall');
				if(snow) {
					snow.clear();
				}
			});
		}
	};
})(jQuery);



       $(window).scroll(function(){
            
        if($(window).scrollTop() + $(window).height()*1/2  > $(".splunpan-container").offset().top  &&  $(window).scrollTop() + $(window).height()*1/2 < $(".Springonsale-container").offset().top ){
          
          if($(".snowfall-flakes").length == 0){
           $(".lunpanover-img").addClass("active");  
            $(document).snowfall('clear');  
            if($(window).width() > 768){
        $(document).snowfall({
            image: "https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/huaban.png?v=1648800967",
            flakeCount: 300,
            minSize: 10,
            maxSize: 20
        });
            }else{
             $(document).snowfall({
            image: "https://cdn.shopifycdn.net/s/files/1/0077/3953/9515/files/huaban.png?v=1648800967",
            flakeCount: 100,
            minSize: 10,
            maxSize: 20
        });
            }
          setTimeout(function(){   $(document).snowfall('clear'); }, 10000); 
          }
        }else{
        $(document).snowfall('clear');
            $(".lunpanover-img").removeClass("active"); 
        }
             
        });
  


    </script>



  <script>
  $(function(){
       var inter = setInterval(getbox,1500); 
    function getbox(){
      if ($("#wheelOfFortune-shopper-trigger").width() > 0 ){
         console.log("show");
        $(".Springonsale-box-btnbox .splunpanboxbtn-start").click(function(){
          console.log("click");
         $("#wheelOfFortune-shopper-trigger").click();
          console.log("sucessclick");
        });
         clearInterval(inter);
      }
    };
  });

</script>



{% schema %}
  {
    "name": "SpringSale SpintoWin",
"class": "imgtextwrapeprs",
    "settings": [
     {
            "type": "image_picker",
            "id": "image",
            "label": "image"
          },{
            "type": "image_picker",
            "id": "image_over",
            "label": "image_over"
          },{
            "type": "text",
            "id": "title",
            "label": "title"
          },{
            "type": "richtext",
            "id": "content",
            "label": "content"
          },{
            "type": "text",
            "id": "note",
            "label": "note"
          },{
            "type": "text",
            "id": "start_text",
            "label": "start_text"
          },{
            "type": "url",
            "id": "start_url",
            "label": "start_url"
          },{
            "type": "text",
            "id": "check_text",
            "label": "check_text"
          },{
            "type": "url",
            "id": "check_url",
            "label": "check_url"
          }
    ],
    "presets": [
      {
        "name": "SpringSale SpintoWin",
        "category": "Ho-Advance"
 
      }
    ]
  }
{% endschema %}

